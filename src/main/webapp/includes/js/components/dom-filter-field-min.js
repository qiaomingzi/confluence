(function(a){Confluence.DomFilterField=function(k){var d={items:null,matcher:function(m,n){var l=m.text().toLowerCase();return l.indexOf(n)>-1},searcher:function(m,l){if(l!==""){l=l.toLowerCase();m.each(function(){var n=a(this);var o=k.matcher(n,l);n.toggleClass("hidden",!o)})}else{m.removeClass("hidden")}},postSearch:function(l){},placeholderText:AJS.I18n.getText("search.name"),submitCallback:function(l,m){AJS.log("Confluence.DomFilterField submitted with "+l.length+" item(s) for search text >"+m+"<")}};k=a.extend(d,k);var f;function c(){f=a(k.items)}c();function e(){return a.trim(j.filter(":not(.blank-search)").val())}function i(){return e()!==""}function h(){return f.filter(":visible")}var b=a(Confluence.Templates.DomFilterField.form());var j=b.find("input");function g(){k.searcher(f,e());k.postSearch(h())}j.keyup(function(l){g();return AJS.stopEvent(l)}).keyup(function(l){return AJS.stopEvent(l)}).focus(function(l){if(j.hasClass("blank-search")){j.removeClass("blank-search").val("")}l.target.select()}).blur(function(l){if(!i()){j.addClass("blank-search").val(k.placeholderText)}}).blur();if(k.formId){b.attr("id",k.formId)}if(k.inputId){j.attr("id",k.inputId)}b.submit(function(m){AJS.stopEvent(m);var l=h();if(l.length){k.submitCallback(l,e())}return false});return{form:b,reset:function(){if(i()){j.val("").blur();k.searcher(f,"")}},refreshItems:c,filter:g,focus:function(){j.focus()},focusAndSearch:function(l){l=a.trim(l);j.val(l).keyup();l&&j.removeClass("blank-search");j.focus()}}}}(AJS.$));