AJS.toInit(function(f){var g=f("#search-index-task-progress-container"),l=f("#reindex-task-in-progress").length>0,h=f("#build-search-index-button"),k=f("#search-index-exists").length>0,c=f("#search-index-elapsed-time"),d=f("#search-index-elapsed-time-container"),e=f("#search-index-error-status"),i=f("#search-index-success-status"),b=f("#search-index-inprogress-status"),j=f(".indexing-status");h.click(function(){AJS.safe.ajax({url:Confluence.getContextPath()+"/admin/reindex.action",type:"POST",dataType:"json",data:{},success:function(m){g.progressBar(0);d.hide();a()}});return false});if(!k||c.html()==""){d.hide()}g.progressBar(0);if(l){a()}function a(){h.prop("disabled",true);var m=setInterval(function(){f.getJSON(contextPath+"/json/reindextaskprogress.action",function(n){g.progressBar(n.percentageComplete);j.text(n.count+" / "+n.total);d.show();c.html(n.compactElapsedTime);if(n.percentageComplete==100){h.prop("disabled",false);i.show();e.hide();b.hide();clearInterval(m)}})},1000)}if(k&&!l){g.progressBar(100)}if(l){b.show();e.hide();i.hide()}else{if(k){i.show();e.hide();b.hide()}else{e.show();i.hide();b.hide()}}});